<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title><%= title %></title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .container, .container-fluid, .container-lg, .container-md, .container-sm, .container-xl, .container-xxl

 {
    width: 75%;
    padding-right: var(--bs-gutter-x, .75rem);
    padding-left: var(--bs-gutter-x, .75rem);
    margin-right: auto;
    margin-left: 17rem;
}</style>
</head>
<body>
  <%- include('partials/navbar') %>

  <div class="container mt-4">
    <div class="card shadow">
      <div class="card-header bg-dark text-white">
        <h4 class="mb-0">ðŸ§ª Other Investigations</h4>
      </div>
      <div class="card-body">
        <form action="/submit-other-investigation" method="POST">
 
<form action="/submit-other-investigation" method="POST">
  <div class="row mb-3">
    <!-- Patient Dropdown -->
    <div class="col-md-6">
      <label for="patientId" class="form-label">Select Patient *</label>
      <select class="form-select" name="patientId" id="patientId" required onchange="autoFillVisitNumber(this)">
        <option value="">-- Select Patient --</option>
        <% patients.forEach((patient) => { %>
          <option value="<%= patient._id %>" data-visits="<%= patient.investigations?.length || 0 %>">
            <%= patient.name %> - <%= patient.age %> yrs
          </option>
        <% }); %>
      </select>
    </div>

    <!-- Visit Number -->
    <div class="col-md-6">
      <label for="visitNumber" class="form-label">Visit Number *</label>
      <input type="number" class="form-control" id="visitNumber" name="visitNumber" placeholder="e.g. 1" required readonly>
    </div>
  </div>

              <!-- Other Investigations -->
<h5 class="mt-4 mb-3">Other Investigations</h5>
<div class="row">
  <div class="col-md-4 mb-3">
    <label for="cholesterol" class="form-label">Cholesterol</label>
    <input type="text" class="form-control" name="cholesterol" placeholder="150-200 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="triglycerides" class="form-label">Triglycerides</label>
    <input type="text" class="form-control" name="triglycerides" placeholder="150 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="hdlChol" class="form-label">HDL Cholesterol</label>
    <input type="text" class="form-control" name="hdlChol" placeholder="40-60 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="ldlChol" class="form-label">LDL Cholesterol</label>
    <input type="text" class="form-control" name="ldlChol" placeholder="70-110 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="glucoseFasting" class="form-label">Glucose (F)</label>
    <input type="text" class="form-control" name="glucoseFasting" placeholder="70-110 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="glucosePP" class="form-label">Glucose (PP)</label>
    <input type="text" class="form-control" name="glucosePP" placeholder="70-140 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="urea" class="form-label">Blood Urea</label>
    <input type="text" class="form-control" name="urea" placeholder="16-48 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="uricAcid" class="form-label">Uric Acid</label>
    <input type="text" class="form-control" name="uricAcid" placeholder="M: 3.4-7.0, F: 2.4-6.0 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="creatinine" class="form-label">Creatinine</label>
    <input type="text" class="form-control" name="creatinine" placeholder="M: 0.7-1.2, F: 0.5-0.9 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="bilirubinTotal" class="form-label">Total Bilirubin</label>
    <input type="text" class="form-control" name="bilirubinTotal" placeholder="0.2-1.2 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="bilirubinDirect" class="form-label">Direct Bilirubin</label>
    <input type="text" class="form-control" name="bilirubinDirect" placeholder="0.0-0.3 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="bilirubinIndirect" class="form-label">Indirect Bilirubin</label>
    <input type="text" class="form-control" name="bilirubinIndirect" placeholder="0.1-0.9 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="totalProtein" class="form-label">Total Protein</label>
    <input type="text" class="form-control" name="totalProtein" placeholder="6.0-8.0 gm/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="albumin" class="form-label">Albumin</label>
    <input type="text" class="form-control" name="albumin" placeholder="3.5-5.0 gm/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="globulin" class="form-label">Globulin</label>
    <input type="text" class="form-control" name="globulin" placeholder="2.5-3.5 gm/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="sgot" class="form-label">SGOT</label>
    <input type="text" class="form-control" name="sgot" placeholder="Up to 40 IU/L">
  </div>
  <div class="col-md-4 mb-3">
    <label for="sgpt" class="form-label">SGPT</label>
    <input type="text" class="form-control" name="sgpt" placeholder="Up to 40 IU/L">
  </div>
  <div class="col-md-4 mb-3">
    <label for="alkalinePhosphatase" class="form-label">Alkaline Phosphatase</label>
    <input type="text" class="form-control" name="alkalinePhosphatase" placeholder="80-240 IU/L">
  </div>
  <div class="col-md-4 mb-3">
    <label for="calcium" class="form-label">Calcium</label>
    <input type="text" class="form-control" name="calcium" placeholder="8.5-10.5 mg/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="phosphorus" class="form-label">Phosphorus</label>
    <input type="text" class="form-control" name="phosphorus" placeholder="2.5-4.5 mg/dl">
  </div>
</div>

<!-- Serology -->
<h5 class="mt-4 mb-3">Serology</h5>
<div class="row">
  <div class="col-md-4 mb-3">
    <label for="hbsag" class="form-label">HBsAg</label>
    <input type="text" class="form-control" name="hbsag">
  </div>
  <div class="col-md-4 mb-3">
    <label for="widal" class="form-label">WIDAL</label>
    <input type="text" class="form-control" name="widal">
  </div>
  <div class="col-md-4 mb-3">
    <label for="raFactor" class="form-label">RA Factor</label>
    <input type="text" class="form-control" name="raFactor">
  </div>
  <div class="col-md-4 mb-3">
    <label for="psa" class="form-label">PSA</label>
    <input type="text" class="form-control" name="psa">
  </div>
  <div class="col-md-4 mb-3">
    <label for="vdrl" class="form-label">VDRL</label>
    <input type="text" class="form-control" name="vdrl">
  </div>
</div>
 <!-- Other Investigations -->


<!-- Biochemistry -->
<h6 class="mb-2">Biochemistry</h6>
<div class="row">
  <!-- Existing biochemistry fields as previously listed -->
  <!-- (Omitted here for brevity, already included above) -->
</div>

<!-- Haematology -->
<h6 class="mt-4 mb-2">Haematology</h6>
<div class="row">
  <div class="col-md-4 mb-3">
    <label for="hb" class="form-label">Haemoglobin</label>
    <input type="text" class="form-control" name="hb" placeholder="M: 14-18 g/dl, F: 12-16 g/dl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="tlc" class="form-label">TLC</label>
    <input type="text" class="form-control" name="tlc" placeholder="4000-11000 cumm">
  </div>
  <div class="col-md-4 mb-3">
    <label for="neutrophils" class="form-label">Neutrophils</label>
    <input type="text" class="form-control" name="neutrophils" placeholder="50-70%">
  </div>
  <div class="col-md-4 mb-3">
    <label for="lymphocytes" class="form-label">Lymphocytes</label>
    <input type="text" class="form-control" name="lymphocytes" placeholder="20-40%">
  </div>
  <div class="col-md-4 mb-3">
    <label for="monocytes" class="form-label">Monocytes</label>
    <input type="text" class="form-control" name="monocytes" placeholder="2-8%">
  </div>
  <div class="col-md-4 mb-3">
    <label for="eosinophils" class="form-label">Eosinophils</label>
    <input type="text" class="form-control" name="eosinophils" placeholder="1-4%">
  </div>
  <div class="col-md-4 mb-3">
    <label for="basophils" class="form-label">Basophils</label>
    <input type="text" class="form-control" name="basophils" placeholder="0-1%">
  </div>
  <div class="col-md-4 mb-3">
    <label for="plateletCount" class="form-label">Platelet Count</label>
    <input type="text" class="form-control" name="plateletCount" placeholder="1.5-4.5 lac/cumm">
  </div>
</div>

<!-- RBC Indices -->
<h6 class="mt-4 mb-2">RBC Indices</h6>
<div class="row">
  <div class="col-md-4 mb-3">
    <label for="pcv" class="form-label">PCV (HCT)</label>
    <input type="text" class="form-control" name="pcv" placeholder="M: 40-54%, F: 36-47%">
  </div>
  <div class="col-md-4 mb-3">
    <label for="mcv" class="form-label">MCV</label>
    <input type="text" class="form-control" name="mcv" placeholder="82-101 fl">
  </div>
  <div class="col-md-4 mb-3">
    <label for="mch" class="form-label">MCH</label>
    <input type="text" class="form-control" name="mch" placeholder="27-32 pg">
  </div>
  <div class="col-md-4 mb-3">
    <label for="mchc" class="form-label">MCHC</label>
    <input type="text" class="form-control" name="mchc" placeholder="31.5-34.5 gm/dl">
  </div>
</div>

<!-- Urine Examination -->
<h6 class="mt-4 mb-2">Urine Examination</h6>
<div class="row">
  <div class="col-md-4 mb-3">
    <label for="urineColor" class="form-label">Colour</label>
    <input type="text" class="form-control" name="urineColor">
  </div>
  <div class="col-md-4 mb-3">
    <label for="urineAppearance" class="form-label">Appearance</label>
    <input type="text" class="form-control" name="urineAppearance">
  </div>
  <div class="col-md-4 mb-3">
    <label for="urineSpecificGravity" class="form-label">Specific Gravity</label>
    <input type="text" class="form-control" name="urineSpecificGravity" placeholder="1.005â€“1.030">
  </div>
  <div class="col-md-4 mb-3">
    <label for="urineAlbumin" class="form-label">Albumin</label>
    <input type="text" class="form-control" name="urineAlbumin">
  </div>
  <div class="col-md-4 mb-3">
    <label for="urineSugar" class="form-label">Sugar</label>
    <input type="text" class="form-control" name="urineSugar">
  </div>
  <div class="col-md-4 mb-3">
    <label for="urinePusCell" class="form-label">Pus Cell</label>
    <input type="text" class="form-control" name="urinePusCell">
  </div>
  <div class="col-md-4 mb-3">
    <label for="urineRBC" class="form-label">RBC</label>
    <input type="text" class="form-control" name="urineRBC">
  </div>
  <div class="col-md-4 mb-3">
    <label for="urineCrystals" class="form-label">Crystals</label>
    <input type="text" class="form-control" name="urineCrystals">
  </div>
</div>


          <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <a href="/home" class="btn btn-secondary me-md-2">Back</a>
            <button type="submit" class="btn btn-primary">Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
<script>
  function autoFillVisitNumber(selectElement) {
    const selectedOption = selectElement.options[selectElement.selectedIndex];
    const currentVisits = parseInt(selectedOption.getAttribute('data-visits')) || 0;
    document.getElementById("visitNumber").value = currentVisits + 1;
  }
</script>

</html>
